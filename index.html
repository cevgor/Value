<!DOCTYPE html>
<html lang="ru">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=no">
<title>D!CKP!C DEFENSE</title>
<style>
html, body {
  margin: 0;
  padding: 0;
  background: #0e0e0e;
  color: #fff;
  font-family: system-ui, sans-serif;
  touch-action: manipulation;
}
#ui {
  position: fixed;
  top: 0;
  width: 100%;
  text-align: center;
  padding: 8px;
  background: rgba(0,0,0,0.6);
  z-index: 10;
}
#ui span {
  margin: 0 10px;
}
canvas {
  display: block;
}
#hint {
  position: fixed;
  bottom: 10px;
  width: 100%;
  text-align: center;
  font-size: 12px;
  opacity: 0.6;
}
</style>
</head>
<body>

<div id="ui">
  <span>‚ù§Ô∏è <b id="lives">3</b></span>
  <span>üõ°Ô∏è <b id="score">0</b></span>
  <span>üí∞ <b id="money">10</b></span>
</div>

<canvas id="game"></canvas>

<div id="hint">–¢–∞–ø–Ω–∏ –ø–æ —ç–∫—Ä–∞–Ω—É, —á—Ç–æ–±—ã –ø–æ—Å—Ç–∞–≤–∏—Ç—å –∑–∞—â–∏—Ç—É üõ°Ô∏è</div>

<script>
const canvas = document.getElementById("game");
const ctx = canvas.getContext("2d");

function resize() {
  canvas.width = window.innerWidth;
  canvas.height = window.innerHeight;
}
resize();
window.addEventListener("resize", resize);

let lives = 3;
let score = 0;
let money = 10;

const enemies = [];
const towers = [];
const projectiles = [];

const enemyEmojis = ["üçÜ", "üì∏", "üòè"];
const towerEmoji = "üõ°Ô∏è";
const projectileEmoji = "‚ùå";

function spawnEnemy() {
  enemies.push({
    x: Math.random() * canvas.width,
    y: -40,
    speed: 0.5 + Math.random(),
    emoji: enemyEmojis[Math.floor(Math.random() * enemyEmojis.length)]
  });
}

setInterval(spawnEnemy, 1200);

canvas.addEventListener("touchstart", e => {
  const touch = e.touches[0];
  if (money >= 5) {
    towers.push({
      x: touch.clientX,
      y: touch.clientY,
      cooldown: 0
    });
    money -= 5;
  }
});

function update() {
  ctx.clearRect(0, 0, canvas.width, canvas.height);

  enemies.forEach((e, i) => {
    e.y += e.speed;
    ctx.font = "32px serif";
    ctx.fillText(e.emoji, e.x, e.y);

    if (e.y > canvas.height) {
      enemies.splice(i, 1);
      lives--;
    }
  });

  towers.forEach(t => {
    ctx.font = "28px serif";
    ctx.fillText(towerEmoji, t.x - 14, t.y + 14);

    if (t.cooldown <= 0 && enemies.length) {
      const target = enemies[0];
      projectiles.push({
        x: t.x,
        y: t.y,
        tx: target.x,
        ty: target.y
      });
      t.cooldown = 40;
    }
    t.cooldown--;
  });

  projectiles.forEach((p, i) => {
    p.x += (p.tx - p.x) * 0.1;
    p.y += (p.ty - p.y) * 0.1;

    ctx.font = "20px serif";
    ctx.fillText(projectileEmoji, p.x, p.y);

    enemies.forEach((e, ei) => {
      if (Math.abs(p.x - e.x) < 20 && Math.abs(p.y - e.y) < 20) {
        enemies.splice(ei, 1);
        projectiles.splice(i, 1);
        score++;
        money++;
      }
    });
  });

  document.getElementById("lives").textContent = lives;
  document.getElementById("score").textContent = score;
  document.getElementById("money").textContent = money;

  if (lives <= 0) {
    ctx.fillStyle = "#fff";
    ctx.font = "32px system-ui";
    ctx.textAlign = "center";
    ctx.fillText("–ß–ê–¢ –ü–ê–õ üòî", canvas.width / 2, canvas.height / 2);
    ctx.font = "18px system-ui";
    ctx.fillText("–û–±–Ω–æ–≤–∏ —Å—Ç—Ä–∞–Ω–∏—Ü—É, —á—Ç–æ–±—ã –Ω–∞—á–∞—Ç—å –∑–∞–Ω–æ–≤–æ", canvas.width / 2, canvas.height / 2 + 30);
    return;
  }

  requestAnimationFrame(update);
}

update();
</script>
</body>
</html>
